function rho = hoi_asy_rho_xi_deriv(fdata, gdata, s)
%function rho = hoi_asy_rho_xi_deriv(fdata, gdata, s)
%
%   Compute the derivatives of the function rho for the asymptotic
%   expansion at a stationary point xi of order 1.
%   These require the derivatives of f up to order 2s+1, and derivatives
%   of g up to order 2s+2.

% $Id: hoi_asy_rho_xi_deriv.m 2 2006-11-03 09:18:49Z daan $

rho = zeros(s+1, 1);

a0 = fdata(1);
a1 = fdata(2);
c2 = gdata(3);

rho(1) = a1;

if s >= 1
    a2 = fdata(3);
    a3 = fdata(4);
    c3 = gdata(4);
    c4 = gdata(5);
    rho(2) = -1/6*(-2*a3*c2^2+2*a1*c2*c4+3*a2*c2*c3-3*a1*c3^2)/c2^3;
end

if s >= 2
    a4 = fdata(5);
    a5 = fdata(6);
    c5 = gdata(6);
    c6 = gdata(7);
    rho(3) = -1/120*(8*c2^3*a1*c6-40*c2^2*a1*c4^2+20*c2^3*a2*c5-130*c2^2*a2*c3*c4+40*c2^3*a3*c4+135*a2*c2*c3^3-8*c2^4*a5-90*c2^2*a3*c3^2-55*c2^2*a1*c5*c3+220*a1*c3^2*c4*c2+35*c2^3*a4*c3-135*a1*c3^4)/c2^6;
end

if s >= 3
    a6 = fdata(7);
    a7 = fdata(8);
    c7 = gdata(8);
    c8 = gdata(9);
    rho(4) = -1/5040*(12145*c2^3*a1*c3*c4*c5+168*c2^5*a2*c7+48*c2^5*a1*c8+22050*c2*a2*c3^5+672*c2^5*a5*c4-14700*c2^2*a3*c3^4+6405*c2^3*a4*c3^3+448*c2^5*a3*c6-2800*c2^4*a3*c4^2-630*c2^4*a1*c5^2-1995*c2^4*a5*c3^2-17535*c2^2*a1*c3^3*c5+11130*c2^3*a2*c3^2*c5+19950*c2^3*a3*c3^2*c4-48*c2^6*a7+57435*c2*a1*c4*c3^4-2940*c2^4*a2*c4*c5-581*c2^4*a1*c3*c7+14420*c2^3*a2*c3*c4^2+3906*c2^3*a1*c3^2*c6-1911*c2^4*a2*c3*c6-4095*c2^4*a3*c3*c5-5110*c2^4*a4*c3*c4-34370*c2^2*a1*c3^2*c4^2-1120*c2^4*a1*c4*c6-42735*c2^2*a2*c4*c3^3-22050*a1*c3^6+413*c2^5*a6*c3+2800*c2^3*a1*c4^3+630*c2^5*a4*c5)/c2^9;
end

if s >= 4
    a8 = fdata(9);
    a9 = fdata(10);
    c9 = gdata(10);
    c10 = gdata(11);
    rho(5) = -1/120960*(333732*c2^5*a2*c6*c3*c4-2613240*c2^4*a2*c5*c3^2*c4+708120*c2^5*a3*c3*c4*c5-911232*c2^4*a1*c4*c6*c3^2+5310690*c2^3*a1*c5*c3^3*c4-1404900*c2^4*a1*c4^2*c5*c3+100632*c2^5*a1*c4*c7*c3+140070*c2^5*a1*c5*c6*c3-8904*c2^6*a1*c5*c7+441420*c2^5*a4*c4^2*c3-540225*c2^4*a1*c5^2*c3^2+4441500*c2^3*a3*c3^4*c4-29064*c2^6*a2*c5*c6+341880*c2^5*a4*c3^2*c5+230580*c2^5*a3*c3^2*c6-5376*c2^6*a1*c6^2-1918350*c2^2*a3*c3^6+1920*c2^7*a3*c8-14100*c2^6*a7*c3^2+3696*c2^7*a4*c7+128*c2^7*a1*c10-40320*c2^6*a5*c4^2+5376*c2^7*a5*c6-295470*c2^4*a5*c3^4+870975*c2^3*a4*c3^5-2877525*a1*c3^8+74970*c2^5*a6*c3^3-31080*c2^6*a3*c5^2-28980*c2^6*a3*c7*c3+3840*c2^7*a7*c4+1815*c2^7*a8*c3+2877525*c2*a2*c3^7+5208*c2^7*a6*c5+156800*c2^5*a3*c4^3+576*c2^7*a2*c9-20832*c2^6*a2*c7*c4+108360*c2^5*a1*c5^2*c4+866250*c2^3*a1*c6*c3^4-77280*c2^6*a4*c4*c5-156800*c2^4*a1*c4^4+92820*c2^5*a2*c3^2*c7-2391*c2^6*a1*c9*c3-2314200*c2^4*a3*c3^2*c4^2-5760*c2^6*a1*c4*c8-3407985*c2^2*a1*c3^5*c5+2537010*c2^3*a2*c3^4*c5-1198890*c2^4*a3*c3^3*c5-1498560*c2^4*a4*c3^3*c4-50820*c2^6*a6*c4*c3+6468420*c2^3*a2*c4^2*c3^3+3432240*c2^3*a1*c4^3*c3^2+94080*c2^5*a1*c4^2*c6-10140*c2^6*a2*c8*c3+198345*c2^5*a2*c5^2*c3-167790*c2^4*a1*c7*c3^3+346920*c2^5*a5*c3^2*c4-8404200*c2^2*a2*c3^5*c4-53760*c2^6*a3*c4*c6-60690*c2^6*a5*c3*c5-10909920*c2^2*a1*c4^2*c3^4-570780*c2^4*a2*c6*c3^3+10322550*c2*a1*c3^6*c4-1118040*c2^4*a2*c4^3*c3+255360*c2^5*a2*c4^2*c5+24240*c2^5*a1*c3^2*c8-50316*c2^6*a4*c3*c6-128*c2^8*a9)/c2^12;
end

if s >= 5
    warningdata('s too high in hoi_asy_rho_xi_deriv');
end

