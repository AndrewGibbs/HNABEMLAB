function [x,w] = quad_halfchebyshev(n, a, b)
%function [x,w] = quad_halfchebyshev(n, a, b)
%
%   Compute the 'half-Chebyshev' rules on [a,b].

alpha = [.636619772367581344, .483614594417637246, .494243324894724524, .497177532124107266, .498333824808563066, .498901616654570512, .499221684398568915, .499419716358611519, .499550724686707502, .499641878088027090, .499707850247150682, .499757132539721241, .499794916047482649, .499824519507708196, .499848145064873629, .499867300611932863, .499883046833277535, .499896147439718273, .499907163648399880, .499916515362983998, .499924521823501552, .499931429238856847, .499937429957419894, .499942676012939767, .499947288855884074, .499951366450342247, .499954988521191667, .499958220482723171, .499961116414259588, .499963721338119388, .499966072980801142, .499968203147165405, .499970138801843090, .499971902927050933, .499973515208132193, .499974992585259799, .499976349700353137, .499977599261352909, .499978752340869361, .499979818622376818, .499980806604225690, .499981723769534495, .499982576728331295, .499983371337006776, .499984112799125517, .499984805750847745, .499985454333589208, .499986062256052589, .499986632847370887, .499987169102788988, .499987673723057274, .499988149148507332, .499988597588614704, .499989021047719050, .499989421347462143, .499989800146413787, .499990158957281361, .499990499162037109, .499990822025246216, .499991128705836160, .499991420267512236, .499991697687994367, .499991961867225215, .499992213634678476, .499992453755878366, .499992682938226100, .499992901836216319, .499993111056115365, .499993311160163945, .499993502670358658, .499993686071859912, .499993861816067857, .499994030323402765, .499994191985821881, .499994347169100916, .499994496214904991, .499994639442670961, .499994777151320487, .499994909620821046, .499995037113610095, .499995159875895942, .499995278138847362, .499995392119682714, .499995502022668135, .499995608040033394, .499995710352813063, .499995809131619905, .499995904537356632, .499995996721871593, .499996085828563383, .499996171992938862, .499996255343128658, .499996336000363799, .499996414079416801, .499996489689010203, .499996562932195268, .499996633906703310, .499996702705271899, .499996769415947953]';
beta = [2., 0.947152654306489142e-1, 0.648199848450415727e-1, 0.634813177967503796e-1, 0.630339813351520283e-1, 0.628349909854697062e-1, 0.627296477936243508e-1, 0.626672173875214870e-1, 0.626271907733669882e-1, 0.625999969282617353e-1, 0.625806809570566125e-1, 0.625664683587561622e-1, 0.625557070419031281e-1, 0.625473633180751703e-1, 0.625407635072795747e-1, 0.625354532901493167e-1, 0.625311172415515189e-1, 0.625275308140896631e-1, 0.625245306316513983e-1, 0.625219955261159930e-1, 0.625198340953306008e-1, 0.625179763395047747e-1, 0.625163679165540010e-1, 0.625149661193042442e-1, 0.625137370089627975e-1, 0.625126533400214745e-1, 0.625116930363462301e-1, 0.625108380572512925e-1, 0.625100735435234091e-1, 0.625093871670985732e-1, 0.625087686307160876e-1, 0.625082092792821660e-1, 0.625077017953205049e-1, 0.625072399583408714e-1, 0.625068184532407006e-1, 0.625064327166440315e-1, 0.625060788128290902e-1, 0.625057533329074009e-1, 0.625054533124043895e-1, 0.625051761635006480e-1, 0.625049196190273555e-1, 0.625046816859419227e-1, 0.625044606064931383e-1, 0.625042548256568489e-1, 0.625040629637111407e-1, 0.625038837930444364e-1, 0.625037162184659502e-1, 0.625035592604267907e-1, 0.625034120406701442e-1, 0.625032737699167859e-1, 0.625031437372625462e-1, 0.625030213010210353e-1, 0.625029058807907748e-1, 0.625027969505631426e-1, 0.625026940327179363e-1, 0.625025966927782690e-1, 0.625025045348170007e-1, 0.625024171974238242e-1, 0.625023343501561396e-1, 0.625022556904085105e-1, 0.625021809406452162e-1, 0.625021098459485539e-1, 0.625020421718423803e-1, 0.625019777023561359e-1, 0.625019162382994559e-1, 0.625018575957215898e-1, 0.625018016045333466e-1, 0.625017481072722635e-1, 0.625016969579942320e-1, 0.625016480212769969e-1, 0.625016011713228055e-1, 0.625015562911490908e-1, 0.625015132718574544e-1, 0.625014720119724103e-1, 0.625014324168423829e-1, 0.625013943980963498e-1, 0.625013578731503006e-1, 0.625013227647583571e-1, 0.625012890006039971e-1, 0.625012565129273376e-1, 0.625012252381848875e-1, 0.625011951167385768e-1, 0.625011660925712189e-1, 0.625011381130258674e-1, 0.625011111285668036e-1, 0.625010850925601251e-1, 0.625010599610721210e-1, 0.625010356926838040e-1, 0.625010122483201366e-1, 0.625009895910926364e-1, 0.625009676861541750e-1, 0.625009465005649033e-1, 0.625009260031683388e-1, 0.625009061644767447e-1, 0.625008869565650129e-1, 0.625008683529723367e-1, 0.625008503286110272e-1, 0.625008328596818863e-1, 0.625008159235956024e-1]';
[x,w] = compute_gauss(n/2,alpha,beta);

x = 2/pi*acos(x);
x = [-x; flipud(x)];
w = 1/2*[w; flipud(w)];

return

%% Explicit rules follow:
% switch n
%     case 2
%         x = [.636619772367581343];
%         w = [2];
%     case 4
%         x = [.242992741650061754, .877241625135156835];
%         w = [.758761612461648527, 1.24123838753835147];
%     case 6
%         x = [.123876428879201498, .550078522900829444, .940522739899912172];
%         w = [.393126684220052671, .734446730538271746, .872426585241675583];
%     case 8
%         x = [0.745587701221673477e-1, .355648676811510594, .716255810983754665, .965191965886617773];
%         w = [.238924030887032662, .478667550740999749, .612936761522546726, .669471656849420863];
%     case 10
%         x = [0.496695345477100284e-1, .245063806808539201, .530423182111313192, .807617036986397356, .977215488158653669];
%         w = [.160081762369259517, .334403090862639707, .449243146525434011, .513896638863103321, .542375361379563444];
%     case 12
%         x = [0.354163423010530347e-1, .178064054154739770, .400481974905407075, .649167013514584107, .861814374752082289, .983946905639317682];
%         w = [.114554287856414959, .245807241641804570, .341448075881513943, .403351105204545899, .439255329586885006, .455583959828835623];
%     case 14
%         x = [0.265110015460471328e-1, .134854668344622502, .310357395075045605, .521823071524466356, .730236492376284105, .896242996440287722, .988086724358999449];
%         w = [0.859529295416621499e-1, .187812870474957742, .267282159827468496, .323502340404705454, .360409398742067414, .382407202800483844, .392633098208654900];
%     case 16
%         x = [0.205815032172638860e-1, .105508067742862795, .246475748976415684, .424195560014904619, .613527480289164976, .787072970095255724, .919359439265792511, .990811296422704197];
%         w = [0.668377089158344473e-1, .147924669229845341, .214339950093949309, .264384984442774518, .299877094105190047, .323628020080690043, .338090330387561147, .344917242744155148];
%     case 18
%         x = [0.164373221293238603e-1, 0.847223806101679637e-1, .199967738467880602, .349647405189115699, .517008088624902969, .682910763487002362, .828104570833154419, .935585864941123768, .992698656428400251];
%         w = [0.534423304521686502e-1, .119386073966389142, .175370724195271427, .219593044118111822, .252735909017049464, .276514578718568555, .292708883806481377, .302732176173486762, .307516279552472801];
%     case 20
%         x = [0.134282483843586572e-1, 0.694871238506119055e-1, .165229282898357096, .292182309608720704, .438817309663801746, .591551320859217744, .736030889552123737, .858545000002091659, .947393707327564977, .994059476652250757];
%         w = [0.436969970941748873e-1, 0.983006306159422079e-1, .145935638328569660, .184956593594778233, .215459973375697474, .238444877432317455, .255152264760497072, .266699025379084036, .273935746760815171, .277418252658123805];
%     case 22
%         x = [0.111749858198043869e-1, 0.579993418241619520e-1, .138677539275330282, .247280386206619699, .375641243915884625, .513932026043268475, .651416109209502195, .777312468042167812, .881681105941229244, .956244587018032138, .995072725750248858 ];
%         w = [0.363887198627496499e-1, 0.823006672907585712e-1, .123206566999566165, .157690877387859935, .185562446954962390, .207365775826750465, .223941066023725510, .236136172481644127, .244665924240344859, .250063942012588708, .252677840919049619 ];
%     case 24
%         x = [0.00944426871940090587, 0.0491292185629170415, 0.117967388400050583,      0.211688316551029989, 0.324357289412371050, 0.448722769422595156,      0.576674390361475800, 0.699784708582641540, 0.809887138692593648,      0.899641726480412319, 0.963045071415533196, 0.995847364984949678];
%         w = [0.0307688934182507837, 0.0698837295276114137, 0.105319006457770423,       0.135887731634163734, 0.161271595329100531, 0.181732408228115096,       0.197823130595114421, 0.210170838146705161, 0.219351869494644904,       0.225836201181840101, 0.229971276069087022, 0.231983319917596410];
%     case 26
%         x = [0.00808628489153752185, 0.0421409652087408867, 0.101523820796053215, 0.183082657279735160, 0.282406749785092201, 0.394045692740462139, 0.511797524144379416, 0.629057065519409148, 0.739198896813498177,     0.835966998561208331, 0.913844575854296225, 0.968380538742884266,      0.996452797296156869];
%         w = [0.0263554235085639251, 0.0600609200203269801, 0.0910069561187972865,      0.118208660520597100, 0.141305167660878395, 0.160386055756808611,      0.175802900031467524, 0.188010038412234866, 0.197460420776079136,      0.204550554823421446, 0.209598020173738196, 0.212836526249294313,      0.214418355947792222];
%     case 28
%         x =   [0.00700127153360067743, 0.0365393551841370729, 0.0882624002401769032,      0.159793899847615086, 0.247790379773255461, 0.348084711981262824,      0.455873030623075535, 0.565944259481831707, 0.672938341978545008,      0.771616714578580873, 0.857128719845007779, 0.925258931885060460,      0.972642148583369242, 0.996934921605643122];
%         w =    [0.0228265821597829213, 0.0521607189054907462, 0.0793884060551379442,      0.103694906940797888, 0.124720006621946142, 0.142451096972526394,      0.157100739478145509, 0.168991754384454532, 0.178473618901341871,      0.185872306092617592, 0.191465462561203518, 0.195473279157128093,      0.198057494348829316, 0.199323627420597532];
%     case 30
%         x = [0.00612072290556570354, 0.0319814688303905765, 0.0774190779636723238, 0.140608564203732136, 0.218970896681721271, 0.309270174187544812, 0.407738320623322753, 0.510229860523005724, 0.612399174931812697,  0.709890406839375926, 0.798529827559664006, 0.874510958815418526, 0.934563612459000903, 0.976099093282203661, 0.997325072399604363];
%         w = [0.0199610603993550145, 0.0457146581113998389, 0.0698348008834285439,      0.0916467508036129720, 0.110811688741360223, 0.127258822393358660,      0.141106005552220029, 0.152577669810901843, 0.161939376705499739,      0.169454368567246361, 0.175359033359950752, 0.179851506636457367,      0.183088072979409134, 0.185183481567575105, 0.186212703488224418];
%     case 32
%         x = [0.00539633963465284956, 0.0282239114830602356, 0.0684441435888946494,      0.124632756233718747, 0.194769392226260186, 0.276305603815022636,      0.366250175596220123, 0.461275767627286397, 0.557842740162570648,      0.652334214211948083, 0.741195912282043581, 0.821074432993989808,      0.888948022127445591, 0.942244467651433053, 0.978941421850088218,      0.997645231333333438];
%         w =    [0.0176026058465393874, 0.0403881428360976057, 0.0618891225308885974,      0.0815448698664286363, 0.0990466443973670045, 0.114292857649566128,      0.127337704040414292, 0.138332932251421205, 0.147477458954983698,      0.154980960615596043, 0.161041136910501975, 0.165831494349290841,      0.169496068839128695, 0.172148149381502816, 0.173870946448452849,      0.174718905081820227];
%     case 34
%         x =    [0.00479327960659258653, 0.0250901457824858083, 0.0609345342366181963,      0.111198898877055016, 0.174278580325511174, 0.248140737351110600,      0.330384086548140807, 0.418313864322340191, 0.509029793048104531,      0.599523417705783819, 0.686780671852689210, 0.767885472332337383,      0.840120315666411956, 0.901060143271207581, 0.948656112113073141,      0.981306339861222259, 0.997911186750561520];
%         w = [0.0156383699605004701, 0.0359371970705250345, 0.0552130655562010674,      0.0729979365753023803, 0.0890154843896749862, 0.103150171306990091,      0.115414095312961823, 0.125905852002617847, 0.134772180972954520,      0.142178140978867838, 0.148286898926502745, 0.153247672331605572,      0.157189553962668520, 0.160219089231720769, 0.162419968050771427,      0.163853707627658880, 0.164560615742476029];
%     case 36
%         x =    [0.00428589866570838314, 0.0224496538279694242, 0.0545896131892907413,      0.0998017182788276881, 0.156795649294581691, 0.223930956799831467,      0.299259770213042321, 0.380580471720619868, 0.465501191384798845,      0.551510884213472523, 0.636055303489562231, 0.716615058431759051,      0.790782996778699923, 0.856338301221308125, 0.911314892722085513,      0.954061979310687877, 0.983294872602794937, 0.998134514945923440];
%         w =    [0.0139852141464805678, 0.0321806279195890692, 0.0495521365634216902,      0.0657069803454780253, 0.0804003751397764227, 0.0935130163312542930,      0.105029780307174439, 0.115010748265238734, 0.123562237199260480,      0.130812753052654734, 0.136895529111425412, 0.141937220931310565,      0.146051418846860346, 0.149335497999842388, 0.151869548517081334,      0.153716453206763675, 0.154922479403302448, 0.155517982713085377];
%     case 38
%         x =    [0.00385498447387350043, 0.0202042855698077845, 0.0491816449669792390,      0.0900538887713762879, 0.141771868139367007, 0.202997768950165470,      0.272136228175839274, 0.347373424489459127, 0.426723601521271503,      0.508081635392454097, 0.589279887704456970, 0.668147442162944135,      0.742569815054930566, 0.810547298147492313, 0.870250204595377419,      0.920069429856581489, 0.958660905899362994, 0.984982717142349833,      0.998323859725274924];
%         w =    [0.0125808006465414547, 0.0289816493541707746, 0.0447120882049254981,     0.0594407012903477042, 0.0729518768145111402, 0.0851285258797006690,      0.0959385027844508697, 0.105414247201464057, 0.113631020303642020,      0.120687734702976741, 0.126692170138976996, 0.131750734815626433,      0.135962069592204959, 0.139413513147710506, 0.142179496109447240,      0.144321115868078848, 0.145886348597429887, 0.146910530618038145,      0.147416873929756056];
%     case 40
%         x =    [0.00348591410824438703, 0.0182790999708908398, 0.0445356810920338834,      0.0816549327564307213, 0.128775184397980173, 0.184794904897700634,      0.248395767264193763, 0.318071567776062181, 0.392162795438975208,      0.468895987880937552, 0.546426711842589382, 0.622884869897111350,      0.696420999168570221, 0.765252252246432169, 0.827706810016919724,      0.882265557909888124, 0.927599956003178845, 0.962605148096732611,      0.986427484838261013, 0.998485780499215147];
%         w =    [0.0113776496750285651, 0.0262354714170488024, 0.0405426906197628017,      0.0540180813760285123, 0.0664722613502148608, 0.0777937061244323779,      0.0879401960695509570, 0.0969245525580661967, 0.104798348814353273,      0.111636751523184911, 0.117526185959544230, 0.122555288020756191,      0.126808856330722089, 0.130364190351437388, 0.133289147599265175,      0.135641337685045168, 0.137468001350183500, 0.138806250129667656,      0.139683446949060498, 0.140117586096646849];
%     case 42
%         x =    [0.00316739905423474403, 0.0166160881397572458, 0.0405156001048356403,      0.0743691358730105665, 0.117462510964898019, 0.168880754510494269,      0.227525476609248345, 0.292136573584295869, 0.361318253954284631,      0.433568847436186712, 0.507313623562070319, 0.580939725937761009,      0.652832281869382774, 0.721410747877965395, 0.785164580818409506,      0.842687371134889973, 0.892708634173371472, 0.934122525615234611,      0.966012827503779852, 0.987673641717923566, 0.998625327483814964];
%         w =    [0.0103390860826297907, 0.0238607452969276765, 0.0369263544411852820,      0.0492959469457783723, 0.0608033371510962555, 0.0713442745904040350,      0.0808711602444435553, 0.0893830876510270273, 0.0969136853817922224,      0.103519201322835959, 0.109268322541134969, 0.114234321945666665,      0.118489503867917524, 0.122101596786413561, 0.125131634358625266,      0.127632884734480692, 0.129650462810780592, 0.131221347800930290,      0.132374607953129156, 0.133131697780579225, 0.133506740312221883];
%     case 44
%         x =    [0.00289061297420621334, 0.0151697883418527902, 0.0370142519836932572,      0.0680096625933665592, 0.107559127119057117, 0.154896502483429152,      0.209099662427519680, 0.269107006442275023, 0.333737294734648238,      0.401712475942580902, 0.471682989252643991, 0.542254920567189911,      0.612018344748712504, 0.679576174715090863, 0.743572849819034262,      0.802722221896137997, 0.855834033010623881, 0.901838422279485525,      0.939807949555875125, 0.968976680994498273, 0.988755945363655812,      0.998746439919129251];
%         w =    [0.00943641918901229725, 0.0217935565662856167, 0.0337700240914627445,      0.0451599468063712351, 0.0558174536026866764, 0.0656462699158696704,      0.0745965535861391389, 0.0826579759183840504, 0.0898506685071686060,      0.0962158968364143851, 0.101807726266399546, 0.106686296626962559,      0.110912828494841786, 0.114546190069684621, 0.117640723982165069,      0.120245011373716536, 0.122401285329872285, 0.124145262086117220,      0.125506216240910815, 0.126507176182416408, 0.127165155229645106,      0.127491363097473629];
%     case 46
%         x =    [0.00264857444694863503, 0.0139041690976889169, 0.0339463901321404705,      0.0624269882761956490, 0.0988432798828075270, 0.142548981366909489,      0.192764478390423289, 0.248589537440300776, 0.309018595794447635,      0.372958425468933307, 0.439247821715305995, 0.506678882483429906,      0.574019400795487197, 0.640035875302877084, 0.703516645970511302,      0.763294675206534603, 0.818269515881839036, 0.867428034602604567,      0.909863490524435095, 0.944792606677060302, 0.971570312081697306,      0.989701878682420740, 0.998852226901127395];
%         w =    [0.00864694511075304457, 0.0199831364809924716, 0.0309993146071013352,      0.0415179224992854702, 0.0514107792696767013, 0.0605896816491718890,      0.0690046055638397325, 0.0766389334804444288, 0.0835027273320760439,      0.0896254521201739746, 0.0950491946511230744, 0.0998229625730432535,      0.103998265957657899, 0.107625930168047532, 0.110753956135591372,      0.113426199252616805, 0.115681645599390845, 0.117554096772563071,      0.119072114582739185, 0.120259114832510014, 0.121133531200820040,      0.121708995024910995, 0.121994495135470824];
%     case 48
%         x =    [0.00243570294060027709, 0.0127903784726445839, 0.0312435287222470994,      0.0575003734545428662, 0.0911345916448575573, 0.131597278903301278,      0.178224993582127389, 0.230249655956008357, 0.286810460538089841,      0.346967678764730668, 0.409718115345211360, 0.474011913210548984,      0.538770362568905048, 0.602904351219341144, 0.665333089480546897,      0.725002748879672822, 0.780904665872933614, 0.832092778532178180,      0.877699984492043246, 0.916953132194607867, 0.949186384482530423,      0.973852723783748413, 0.990533401329105954, 0.998945168764542120];
%         w = [0.00795250854443142426, 0.0183887529527862703, 0.0285542126467541534,      0.0382949776470821375, 0.0474982260081153540, 0.0560835684107170388,      0.0640021205399886650, 0.0712332451516545623, 0.0777795651143731349,      0.0836613003314097569, 0.0889107752709229580, 0.0935676241154162866,      0.0976749289426867806, 0.101276315481629009, 0.104413906366682972,      0.107126976176234707, 0.109451142561949334, 0.111417942998290372,      0.113054672552917262, 0.114384385770014752, 0.115425990747710918,      0.116194384027545350, 0.116700590809911846, 0.116951886830774955];
%     case 50
%         x =    [0.00224749461514572752, 0.0118050953096296503, 0.0288501507403852023,      0.0531315085189717241, 0.0842852660573911749, 0.121842278009027397,      0.165234531805884235, 0.213802937869195027, 0.266806702821421172,      0.323434214793363433, 0.382815279888495742, 0.444034493837920013,      0.506145499002605310, 0.568185858875488397, 0.629192275688877072,      0.688215878001957558, 0.744337311648409047, 0.796681377591267969,      0.844430973238247317, 0.886840109254795408, 0.923245791741637408,      0.953078579757405208, 0.975871650486360656, 0.991268228737227978,      0.999027263699840236];
%         w =    [0.00733845191996570521, 0.0169774250992033533, 0.0263858843645510142,      0.0354297698499623693, 0.0440095782416563285, 0.0520522839068355785,      0.0595109571975615925, 0.0663625744813532661, 0.0726043317443136253,      0.0782492458946505333, 0.0833217217206157484, 0.0878535434841239336,      0.0918805315296101397, 0.0954399333013264073, 0.0985685070071250160,      0.101301197718809951, 0.103670285389746102, 0.105704887408738507,      0.107430713359381756, 0.108869988907348896, 0.110041484734174821,      0.110960603019261796, 0.111639487421046437, 0.112087132891000807,      0.112309479407636317];
%     otherwise
%         error('Value of n not implemented in quad_halfchebyshev (n too large or odd)');
% end
% 
% x = 2/pi*acos(x);
% x = [-x fliplr(x)]';
% w = 1/2*[w fliplr(w)]';


